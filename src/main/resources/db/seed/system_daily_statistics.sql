-- system_daily_statistics (일별 집계 데이터 - 2024-12-24 ~ 2025-12-23, 365일)
-- 사용자 수, 활성 사용자, 포스팅 수, AI 요청 및 비용 통계
-- 현실적인 변동성: 주말 감소, 주중 증가, 월말/월초 변동, 랜덤 이벤트 등

-- 2024년 12월 (8일)
INSERT INTO system_daily_statistics (stat_date, total_users, user_growth_rate, active_users_today, active_user_growth_rate, posts_today, post_growth_rate, total_ai_requests, total_ai_cost, ai_cost_growth_rate, created_at, updated_at)
VALUES
-- 12월 24일 (화) - 크리스마스 이브, 활동 감소
('2024-12-24', 100, 0.00, 38, 0.00, 6, 0.00, 12, 10.20, 0.00, NOW(), NOW()),
-- 12월 25일 (수) - 크리스마스, 더욱 감소
('2024-12-25', 102, 2.00, 25, -34.21, 4, -33.33, 8, 6.80, -33.33, NOW(), NOW()),
-- 12월 26일 (목) - 복귀 시작
('2024-12-26', 105, 2.94, 52, 108.00, 11, 175.00, 20, 17.00, 150.00, NOW(), NOW()),
-- 12월 27일 (금) - 주말 전 활성화
('2024-12-27', 108, 2.86, 58, 11.54, 13, 18.18, 24, 20.40, 20.00, NOW(), NOW()),
-- 12월 28일 (토) - 주말 감소
('2024-12-28', 110, 1.85, 42, -27.59, 8, -38.46, 15, 12.75, -37.50, NOW(), NOW()),
-- 12월 29일 (일) - 주말 최저
('2024-12-29', 112, 1.82, 35, -16.67, 7, -12.50, 13, 11.05, -13.33, NOW(), NOW()),
-- 12월 30일 (월) - 월요일 복귀
('2024-12-30', 115, 2.68, 61, 74.29, 14, 100.00, 26, 22.10, 100.00, NOW(), NOW()),
-- 12월 31일 (화) - 연말, 활동 감소
('2024-12-31', 118, 2.61, 45, -26.23, 10, -28.57, 18, 15.30, -30.77, NOW(), NOW()),

-- 2025년 1월 (31일)
-- 1월 1일 (수) - 새해 첫날, 최저
('2025-01-01', 120, 1.69, 28, -37.78, 5, -50.00, 10, 8.50, -44.44, NOW(), NOW()),
-- 1월 2일 (목) - 서서히 복귀
('2025-01-02', 123, 2.50, 48, 71.43, 12, 140.00, 22, 18.70, 120.00, NOW(), NOW()),
-- 1월 3일 (금) - 주말 전
('2025-01-03', 126, 2.44, 65, 35.42, 16, 33.33, 30, 25.50, 36.36, NOW(), NOW()),
-- 1월 4일 (토) - 주말
('2025-01-04', 128, 1.59, 48, -26.15, 11, -31.25, 20, 17.00, -33.33, NOW(), NOW()),
-- 1월 5일 (일) - 주말
('2025-01-05', 130, 1.56, 40, -16.67, 9, -18.18, 17, 14.45, -15.00, NOW(), NOW()),
-- 1월 6일 (월) - 월요일 급증
('2025-01-06', 133, 2.31, 72, 80.00, 19, 111.11, 35, 29.75, 105.88, NOW(), NOW()),
-- 1월 7일 (화) - 안정화
('2025-01-07', 136, 2.26, 68, -5.56, 18, -5.26, 34, 28.90, -2.86, NOW(), NOW()),
-- 1월 8일 (수) - 중간
('2025-01-08', 139, 2.21, 71, 4.41, 20, 11.11, 38, 32.30, 11.76, NOW(), NOW()),
-- 1월 9일 (목) - 상승
('2025-01-09', 142, 2.16, 75, 5.63, 22, 10.00, 42, 35.70, 10.53, NOW(), NOW()),
-- 1월 10일 (금) - 주말 전 피크
('2025-01-10', 145, 2.11, 80, 6.67, 25, 13.64, 48, 40.80, 14.29, NOW(), NOW()),
-- 1월 11일 (토) - 주말 하락
('2025-01-11', 147, 1.38, 58, -27.50, 17, -32.00, 32, 27.20, -33.33, NOW(), NOW()),
-- 1월 12일 (일) - 주말
('2025-01-12', 149, 1.36, 52, -10.34, 15, -11.76, 28, 23.80, -12.50, NOW(), NOW()),
-- 1월 13일 (월) - 월요일 반등
('2025-01-13', 152, 2.01, 78, 50.00, 24, 60.00, 46, 39.10, 64.29, NOW(), NOW()),
-- 1월 14일 (화)
('2025-01-14', 155, 1.97, 76, -2.56, 23, -4.17, 44, 37.40, -4.35, NOW(), NOW()),
-- 1월 15일 (수) - 중반 상승
('2025-01-15', 158, 1.94, 82, 7.89, 26, 13.04, 50, 42.50, 13.64, NOW(), NOW()),
-- 1월 16일 (목)
('2025-01-16', 161, 1.90, 84, 2.44, 28, 7.69, 54, 45.90, 8.00, NOW(), NOW()),
-- 1월 17일 (금) - 주말 전 피크
('2025-01-17', 164, 1.86, 90, 7.14, 30, 7.14, 58, 49.30, 7.41, NOW(), NOW()),
-- 1월 18일 (토) - 주말
('2025-01-18', 166, 1.22, 65, -27.78, 21, -30.00, 40, 34.00, -31.03, NOW(), NOW()),
-- 1월 19일 (일) - 주말
('2025-01-19', 168, 1.20, 58, -10.77, 18, -14.29, 35, 29.75, -12.50, NOW(), NOW()),
-- 1월 20일 (월) - 월요일 급증
('2025-01-20', 171, 1.79, 88, 51.72, 32, 77.78, 62, 52.70, 77.14, NOW(), NOW()),
-- 1월 21일 (화)
('2025-01-21', 174, 1.75, 85, -3.41, 30, -6.25, 58, 49.30, -6.45, NOW(), NOW()),
-- 1월 22일 (수)
('2025-01-22', 177, 1.72, 92, 8.24, 34, 13.33, 66, 56.10, 13.79, NOW(), NOW()),
-- 1월 23일 (목) - 설날 연휴 시작 (하락)
('2025-01-23', 180, 1.69, 70, -23.91, 25, -26.47, 48, 40.80, -27.27, NOW(), NOW()),
-- 1월 24일 (금) - 설날 연휴
('2025-01-24', 183, 1.67, 55, -21.43, 18, -28.00, 35, 29.75, -27.08, NOW(), NOW()),
-- 1월 25일 (토) - 설날 연휴
('2025-01-25', 185, 1.09, 42, -23.64, 13, -27.78, 25, 21.25, -28.57, NOW(), NOW()),
-- 1월 26일 (일) - 설날 연휴
('2025-01-26', 187, 1.08, 38, -9.52, 11, -15.38, 22, 18.70, -12.00, NOW(), NOW()),
-- 1월 27일 (월) - 연휴 후 복귀
('2025-01-27', 190, 1.60, 95, 150.00, 38, 245.45, 74, 62.90, 236.36, NOW(), NOW()),
-- 1월 28일 (화) - 안정화
('2025-01-28', 193, 1.58, 92, -3.16, 36, -5.26, 70, 59.50, -5.41, NOW(), NOW()),
-- 1월 29일 (수)
('2025-01-29', 196, 1.55, 98, 6.52, 40, 11.11, 78, 66.30, 11.43, NOW(), NOW()),
-- 1월 30일 (목)
('2025-01-30', 199, 1.53, 102, 4.08, 42, 5.00, 82, 69.70, 5.13, NOW(), NOW()),
-- 1월 31일 (금) - 월말
('2025-01-31', 202, 1.51, 108, 5.88, 46, 9.52, 90, 76.50, 9.76, NOW(), NOW()),

-- 2025년 2월 (28일)
-- 2월 1일 (토) - 주말
('2025-02-01', 204, 0.99, 78, -27.78, 32, -30.43, 62, 52.70, -31.11, NOW(), NOW()),
-- 2월 2일 (일) - 주말
('2025-02-02', 206, 0.98, 68, -12.82, 28, -12.50, 54, 45.90, -12.90, NOW(), NOW()),
-- 2월 3일 (월) - 월초 월요일 급증
('2025-02-03', 209, 1.46, 115, 69.12, 50, 78.57, 98, 83.30, 81.48, NOW(), NOW()),
-- 2월 4일 (화)
('2025-02-04', 212, 1.44, 112, -2.61, 48, -4.00, 94, 79.90, -4.08, NOW(), NOW()),
-- 2월 5일 (수)
('2025-02-05', 215, 1.42, 118, 5.36, 52, 8.33, 102, 86.70, 8.51, NOW(), NOW()),
-- 2월 6일 (목)
('2025-02-06', 218, 1.40, 122, 3.39, 55, 5.77, 108, 91.80, 5.88, NOW(), NOW()),
-- 2월 7일 (금) - 주말 전
('2025-02-07', 221, 1.38, 128, 4.92, 58, 5.45, 114, 96.90, 5.56, NOW(), NOW()),
-- 2월 8일 (토) - 주말
('2025-02-08', 223, 0.90, 92, -28.13, 40, -31.03, 78, 66.30, -31.58, NOW(), NOW()),
-- 2월 9일 (일) - 주말
('2025-02-09', 225, 0.90, 82, -10.87, 35, -12.50, 68, 57.80, -12.82, NOW(), NOW()),
-- 2월 10일 (월) - 월요일
('2025-02-10', 228, 1.33, 125, 52.44, 60, 71.43, 118, 100.30, 73.53, NOW(), NOW()),
-- 2월 11일 (화)
('2025-02-11', 231, 1.32, 120, -4.00, 56, -6.67, 110, 93.50, -6.78, NOW(), NOW()),
-- 2월 12일 (수)
('2025-02-12', 234, 1.30, 130, 8.33, 62, 10.71, 122, 103.70, 10.91, NOW(), NOW()),
-- 2월 13일 (목)
('2025-02-13', 237, 1.28, 135, 3.85, 65, 4.84, 128, 108.80, 4.93, NOW(), NOW()),
-- 2월 14일 (금) - 발렌타인데이 (특수)
('2025-02-14', 240, 1.27, 150, 11.11, 75, 15.38, 148, 125.80, 15.63, NOW(), NOW()),
-- 2월 15일 (토) - 주말
('2025-02-15', 242, 0.83, 108, -28.00, 52, -30.67, 102, 86.70, -31.08, NOW(), NOW()),
-- 2월 16일 (일) - 주말
('2025-02-16', 244, 0.83, 95, -12.04, 45, -13.46, 88, 74.80, -13.73, NOW(), NOW()),
-- 2월 17일 (월) - 월요일
('2025-02-17', 247, 1.23, 138, 45.26, 68, 51.11, 134, 113.90, 52.27, NOW(), NOW()),
-- 2월 18일 (화)
('2025-02-18', 250, 1.21, 132, -4.35, 64, -5.88, 126, 107.10, -5.97, NOW(), NOW()),
-- 2월 19일 (수)
('2025-02-19', 253, 1.20, 142, 7.58, 70, 9.38, 138, 117.30, 9.52, NOW(), NOW()),
-- 2월 20일 (목)
('2025-02-20', 256, 1.19, 148, 4.23, 74, 5.71, 146, 124.10, 5.80, NOW(), NOW()),
-- 2월 21일 (금) - 주말 전
('2025-02-21', 259, 1.17, 155, 4.73, 78, 5.41, 154, 130.90, 5.48, NOW(), NOW()),
-- 2월 22일 (토) - 주말
('2025-02-22', 261, 0.77, 112, -27.74, 54, -30.77, 106, 90.10, -31.17, NOW(), NOW()),
-- 2월 23일 (일) - 주말
('2025-02-23', 263, 0.77, 98, -12.50, 47, -12.96, 92, 78.20, -13.19, NOW(), NOW()),
-- 2월 24일 (월) - 월요일
('2025-02-24', 266, 1.14, 148, 51.02, 76, 61.70, 150, 127.50, 63.04, NOW(), NOW()),
-- 2월 25일 (화)
('2025-02-25', 269, 1.13, 142, -4.05, 72, -5.26, 142, 120.70, -5.33, NOW(), NOW()),
-- 2월 26일 (수)
('2025-02-26', 272, 1.12, 152, 7.04, 78, 8.33, 154, 130.90, 8.45, NOW(), NOW()),
-- 2월 27일 (목)
('2025-02-27', 275, 1.10, 158, 3.95, 82, 5.13, 162, 137.70, 5.19, NOW(), NOW()),
-- 2월 28일 (금) - 월말
('2025-02-28', 278, 1.09, 165, 4.43, 86, 4.88, 170, 144.50, 4.94, NOW(), NOW()),

-- 2025년 3월 (31일) - 봄 시작, 활동 증가 추세
-- 3월 1일 (토) - 주말
('2025-03-01', 280, 0.72, 120, -27.27, 60, -30.23, 118, 100.30, -30.59, NOW(), NOW()),
-- 3월 2일 (일) - 주말
('2025-03-02', 282, 0.71, 105, -12.50, 52, -13.33, 102, 86.70, -13.58, NOW(), NOW()),
-- 3월 3일 (월) - 월초
('2025-03-03', 285, 1.06, 165, 57.14, 88, 69.23, 174, 147.90, 70.59, NOW(), NOW()),
-- 3월 4일 (화)
('2025-03-04', 288, 1.05, 160, -3.03, 84, -4.55, 166, 141.10, -4.59, NOW(), NOW()),
-- 3월 5일 (수)
('2025-03-05', 291, 1.04, 172, 7.50, 92, 9.52, 182, 154.70, 9.64, NOW(), NOW()),
-- 3월 6일 (목)
('2025-03-06', 294, 1.03, 178, 3.49, 96, 4.35, 190, 161.50, 4.39, NOW(), NOW()),
-- 3월 7일 (금)
('2025-03-07', 297, 1.02, 185, 3.93, 100, 4.17, 198, 168.30, 4.21, NOW(), NOW()),
-- 3월 8일 (토) - 주말
('2025-03-08', 299, 0.67, 135, -27.03, 70, -30.00, 138, 117.30, -30.30, NOW(), NOW()),
-- 3월 9일 (일) - 주말
('2025-03-09', 301, 0.67, 118, -12.59, 61, -12.86, 120, 102.00, -13.04, NOW(), NOW()),
-- 3월 10일 (월)
('2025-03-10', 304, 1.00, 180, 52.54, 98, 60.66, 194, 164.90, 61.67, NOW(), NOW()),
-- 3월 11일 (화)
('2025-03-11', 307, 0.99, 175, -2.78, 94, -4.08, 186, 158.10, -4.13, NOW(), NOW()),
-- 3월 12일 (수)
('2025-03-12', 310, 0.98, 188, 7.43, 104, 10.64, 206, 175.10, 10.76, NOW(), NOW()),
-- 3월 13일 (목)
('2025-03-13', 313, 0.97, 192, 2.13, 108, 3.85, 214, 181.90, 3.89, NOW(), NOW()),
-- 3월 14일 (금) - 화이트데이
('2025-03-14', 316, 0.96, 205, 6.77, 118, 9.26, 234, 198.90, 9.39, NOW(), NOW()),
-- 3월 15일 (토) - 주말
('2025-03-15', 318, 0.63, 150, -26.83, 82, -30.51, 162, 137.70, -30.77, NOW(), NOW()),
-- 3월 16일 (일) - 주말
('2025-03-16', 320, 0.63, 132, -12.00, 72, -12.20, 142, 120.70, -12.35, NOW(), NOW()),
-- 3월 17일 (월)
('2025-03-17', 323, 0.94, 195, 47.73, 112, 55.56, 222, 188.70, 56.34, NOW(), NOW()),
-- 3월 18일 (화)
('2025-03-18', 326, 0.93, 188, -3.59, 106, -5.36, 210, 178.50, -5.41, NOW(), NOW()),
-- 3월 19일 (수)
('2025-03-19', 329, 0.92, 202, 7.45, 116, 9.43, 230, 195.50, 9.52, NOW(), NOW()),
-- 3월 20일 (목) - 봄 시작
('2025-03-20', 332, 0.91, 210, 3.96, 122, 5.17, 242, 205.70, 5.22, NOW(), NOW()),
-- 3월 21일 (금)
('2025-03-21', 335, 0.90, 218, 3.81, 128, 4.92, 254, 215.90, 4.96, NOW(), NOW()),
-- 3월 22일 (토) - 주말
('2025-03-22', 337, 0.60, 160, -26.61, 90, -29.69, 178, 151.30, -29.92, NOW(), NOW()),
-- 3월 23일 (일) - 주말
('2025-03-23', 339, 0.59, 140, -12.50, 78, -13.33, 154, 130.90, -13.56, NOW(), NOW()),
-- 3월 24일 (월)
('2025-03-24', 342, 0.88, 212, 51.43, 126, 61.54, 250, 212.50, 62.34, NOW(), NOW()),
-- 3월 25일 (화)
('2025-03-25', 345, 0.88, 205, -3.30, 120, -4.76, 238, 202.30, -4.80, NOW(), NOW()),
-- 3월 26일 (수)
('2025-03-26', 348, 0.87, 220, 7.32, 132, 10.00, 262, 222.70, 10.10, NOW(), NOW()),
-- 3월 27일 (목)
('2025-03-27', 351, 0.86, 228, 3.64, 138, 4.55, 274, 232.90, 4.58, NOW(), NOW()),
-- 3월 28일 (금)
('2025-03-28', 354, 0.85, 235, 3.07, 144, 4.35, 286, 243.10, 4.38, NOW(), NOW()),
-- 3월 29일 (토) - 주말
('2025-03-29', 356, 0.56, 172, -26.81, 100, -30.56, 198, 168.30, -30.77, NOW(), NOW()),
-- 3월 30일 (일) - 주말
('2025-03-30', 358, 0.56, 150, -12.79, 87, -13.00, 172, 146.20, -13.16, NOW(), NOW()),
-- 3월 31일 (월) - 월말

('2025-03-31', 361, 0.84, 230, 53.33, 142, 63.22, 282, 239.70, 63.95, NOW(), NOW());

-- 2025년 4월 ~ 12월 (간략화 - 패턴 유지)
-- 주말마다 약 25-30% 감소, 월요일마다 50-60% 증가
-- 월말/월초에 변동성 증가
INSERT INTO system_daily_statistics (stat_date, total_users, user_growth_rate, active_users_today, active_user_growth_rate, posts_today, post_growth_rate, total_ai_requests, total_ai_cost, ai_cost_growth_rate, created_at, updated_at)
SELECT
    stat_date,
    total_users,
    ROUND(((total_users - LAG(total_users) OVER (ORDER BY stat_date)) / LAG(total_users) OVER (ORDER BY stat_date)) * 100, 2) as user_growth_rate,
    active_users_today,
    ROUND(((active_users_today - LAG(active_users_today) OVER (ORDER BY stat_date)) / LAG(active_users_today) OVER (ORDER BY stat_date)) * 100, 2) as active_user_growth_rate,
    posts_today,
    ROUND(((posts_today - LAG(posts_today) OVER (ORDER BY stat_date)) / LAG(posts_today) OVER (ORDER BY stat_date)) * 100, 2) as post_growth_rate,
    total_ai_requests,
    total_ai_cost,
    ROUND(((total_ai_cost - LAG(total_ai_cost) OVER (ORDER BY stat_date)) / LAG(total_ai_cost) OVER (ORDER BY stat_date)) * 100, 2) as ai_cost_growth_rate,
    NOW() as created_at,
    NOW() as updated_at
FROM (
    SELECT
        DATE_ADD('2025-04-01', INTERVAL seq DAY) as stat_date,
        -- 사용자 수: 점진적 증가 (일평균 0.5~1명)
        FLOOR(364 + seq * 0.7 + (RAND() * 2)) as total_users,
        -- 활성 사용자: 요일별 패턴
        CASE
            -- 토요일 (seq % 7 = 5)
            WHEN (seq % 7) = 5 THEN FLOOR(140 + seq * 0.3 - (RAND() * 40 + 50))
            -- 일요일 (seq % 7 = 6)
            WHEN (seq % 7) = 6 THEN FLOOR(140 + seq * 0.3 - (RAND() * 30 + 60))
            -- 월요일 (seq % 7 = 0)
            WHEN (seq % 7) = 0 THEN FLOOR(180 + seq * 0.4 + (RAND() * 30 + 40))
            -- 금요일 (seq % 7 = 4)
            WHEN (seq % 7) = 4 THEN FLOOR(170 + seq * 0.4 + (RAND() * 20 + 20))
            -- 평일
            ELSE FLOOR(160 + seq * 0.35 + (RAND() * 20 - 10))
        END as active_users_today,
        -- 포스트 수: 활성 사용자 비례, 요일별 패턴
        CASE
            WHEN (seq % 7) = 5 THEN FLOOR(70 + seq * 0.15 - (RAND() * 20 + 25))
            WHEN (seq % 7) = 6 THEN FLOOR(70 + seq * 0.15 - (RAND() * 15 + 30))
            WHEN (seq % 7) = 0 THEN FLOOR(100 + seq * 0.2 + (RAND() * 15 + 25))
            WHEN (seq % 7) = 4 THEN FLOOR(95 + seq * 0.2 + (RAND() * 10 + 15))
            ELSE FLOOR(85 + seq * 0.18 + (RAND() * 10 - 5))
        END as posts_today,
        -- AI 요청: 포스트 수와 비례
        CASE
            WHEN (seq % 7) = 5 THEN FLOOR(140 + seq * 0.3 - (RAND() * 40 + 50))
            WHEN (seq % 7) = 6 THEN FLOOR(140 + seq * 0.3 - (RAND() * 30 + 60))
            WHEN (seq % 7) = 0 THEN FLOOR(200 + seq * 0.4 + (RAND() * 30 + 50))
            WHEN (seq % 7) = 4 THEN FLOOR(190 + seq * 0.4 + (RAND() * 20 + 30))
            ELSE FLOOR(170 + seq * 0.36 + (RAND() * 20 - 10))
        END as total_ai_requests,
        -- AI 비용: 요청 수와 비례
        CASE
            WHEN (seq % 7) = 5 THEN ROUND(119.0 + seq * 0.255 - (RAND() * 34 + 42.5), 2)
            WHEN (seq % 7) = 6 THEN ROUND(119.0 + seq * 0.255 - (RAND() * 25.5 + 51), 2)
            WHEN (seq % 7) = 0 THEN ROUND(170.0 + seq * 0.34 + (RAND() * 25.5 + 42.5), 2)
            WHEN (seq % 7) = 4 THEN ROUND(161.5 + seq * 0.34 + (RAND() * 17 + 25.5), 2)
            ELSE ROUND(144.5 + seq * 0.306 + (RAND() * 17 - 8.5), 2)
        END as total_ai_cost
    FROM (
        SELECT @row := @row + 1 as seq
        FROM (SELECT 0 UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9) t1,
             (SELECT 0 UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9) t2,
             (SELECT 0 UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9) t3,
             (SELECT @row := 0) r
        WHERE @row < 267
    ) nums
    WHERE DATE_ADD('2025-04-01', INTERVAL seq DAY) <= '2025-12-23'
) daily_data;
